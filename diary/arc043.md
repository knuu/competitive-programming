# A 点数変換

- 問題
    - N(10^5以下)個の要素を持つ数列と数字A, B(ともに1以上10^9以下)が与えられたとき、各要素を線形変換(P \* X + Q)する。変換後の数列の平均をA、最大値と最小値の差をBにできるような変換(P, Q)は存在するか。
- 解法
    1. 連立方程式をたてることができる。もとの数列の和をsum\_S、最大値と最小値の差をdiff\_mmとすると、変換後の値より、(P * sum\_S + N * Q) / N = A, diff\_mm * P = Bが成立する。これを解けばよい。ただし、diff\_mm = 0、つまり、全ての数字が同じときは、P, Qは存在しない。sum\_Sとdiff\_mmを求めないといけないのでO(N)。
- 類題
    1. 全員を変換するのではなく、数人のみ変換する場合はどうか？
- 感想
    - 変換が線形だし、順序関係も変わらなさそうだし、もとめるものも平均とかだし、方程式がたてられそうという目処がついた。

# B 難易度

- 問題
    - N(10^5以下)個の要素をもつ数列が与えられる。この中から、4つの要素をもち、i+1個目の要素がi個目の要素の二倍以上であるような部分列は何個あるか。10^9+7で割った余りを求めよ。
- 解法
    1. 数列Dをソートしておいて、dp\[数列の要素の番号\]\[部分列の要素数\] = 何個作れるか でDPする。dp\[i+1\]\[j+1\] = sum(dp\[i\]\[:upper_bound(D[i] / 2) - 1])。計算量は最悪O(N^2)?、部分点解法。
    2. 数列Dをソートしておいて、DP。dp\[i+1\]\[j+1\] = dp\[i+1\]\[j\] + dp\[i\]\[upper_bound(D[i]/2 - 1)\]。O(N)。
    3. 数列をソートしておく。部分列の要素が2個の場合を考える。2つのうち、小さい方の要素がXのとき、大きい方は2X以上となる。つまり、片方がXのときの場合の数は、数列内で2X以上の要素の個数である。同様に、大きい方がXである場合の数も求める。小さい方の場合の数をA\[X\]、大きい方の場合の数をB\[Y\]とすると、A\[X\]は3・4番目、B\[Y\]は1、2番目と考えられるので、Y <= 2Xを満たすX, Yについて、B\[Y\] \* A\[X\]を足したものが答えとなる。O(N^2)、部分点解法。
    4. 3で、予め、Y <= 2Xを満たすものが何個あるかを累積和で求めておく。O(N)。
- 類題
    1. 問題数が4個以上の場合はどうするか。
        - 2の解法は部分列の要素数が増えても使える。問題数をMとすると、O(NM)
- 知見
    - 今回のように、部分列の要素が定数の場合には、それにアドホックな解法も考えてみるべき
    - メモ化再帰の終了条件の順序に気をつけるべき
- 感想
    - 結局、1と2の差と3と4の差は、予め累積和で求めておくかどうかだった。
    
